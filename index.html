<!DOCTYPE html>
<html>
<head>
  <title>Face-Controlled Video</title>
  <style>
    body { margin:0; font-family:sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; background:#000; }
    video { width:640px; height:360px; border:2px solid #fff; }
  </style>
</head>
<body>

<video id="myVideo" muted>
  <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
  Your browser does not support HTML5 video.
</video>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<script>
const videoElement = document.getElementById('myVideo');
const cameraVideo = document.createElement('video');
cameraVideo.style.display = 'none';
document.body.appendChild(cameraVideo);

async function setupCamera() {
  const stream = await navigator.mediaDevices.getUserMedia({ video:true });
  cameraVideo.srcObject = stream;
  await cameraVideo.play();
}

// Mediapipe FaceMesh
const faceMesh = new FaceMesh({locateFile:(file)=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`});
faceMesh.setOptions({
  maxNumFaces:1,
  refineLandmarks:false,
  minDetectionConfidence:0.5,
  minTrackingConfidence:0.5
});

let faceVisible = false;
faceMesh.onResults(results=>{
  if(results.multiFaceLandmarks && results.multiFaceLandmarks.length>0){
    // Face detected
    if(!faceVisible){
      videoElement.play();
      faceVisible = true;
      console.log("Face detected → video playing");
    }
  } else {
    // Face not detected
    if(faceVisible){
      videoElement.pause();
      faceVisible = false;
      console.log("Face lost → video paused");
    }
  }
});

// Start camera
setupCamera().then(()=>{
  const camera = new Camera(cameraVideo,{
    onFrame: async()=>{await faceMesh.send({image:cameraVideo});},
    width:640,
    height:480
  });
  camera.start();
});
</script>

</body>
</html>
